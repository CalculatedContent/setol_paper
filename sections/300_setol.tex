\section{A \SemiEmpirical Theory of (Deep) Learning (\SETOL)}
\label{sxn:setol}
Based on prior empirical results, and the success of the \ALPHA and \ALPHAHAT metrics that are based on the \HTSR \Phenomenology, this leads to the deeper question: 
%
\begin{quote}
\emph{Why do the \ALPHA and \ALPHAHAT metrics work so well as NN model quality metrics for SOTA NN~models?}
\end{quote}
That is, why do NN models with heavier-tailed layer Empirical Spectral Distributions  (ESDs) tend to generalize better when compared to related models\red{, and how can single-layer metrics predict model quality so well}?
Relatedly, can we derive these metrics from first principles?
(If so, then under what conditions do they hold, and under what conditions do they fail?)

\noindent
To answer these questions, we will derive a general expression for the \LayerQuality, $\Q$, of an NN.
Although many modern NNs have many layers, we adopt a single-layer viewpoint (like a matrix-generalized Student–Teacher) because in \StatisticalMechanicsOfGeneralization (\SMOG) theory~\cite{SST92,STS90} the multi-layer generalization can be factorized or approximated.
For this, we will obtain by simple averaging our model quality metrics, under effectively a single layer approximation, that correspond to \ALPHA and \ALPHAHAT.


In deriving these quantities, we will introduce to NN theory a new \SemiEmpirical approach that combines techniques from \STATMECH and \RMT in a novel way.must depend on the spectral density
The \LayerQuality $\Q$ will estimate the contribution that an individual NN layer makes to the overall quality of a trained NN model.
In deriving $\Q$, we have discovered a new \LayerQuality metric, called the \TRACELOG condition,
which indicates that the generalizing components of the layer must concentrate into a low-rank subspace which we term the \emph{\EffectiveCorrelationSpace}, or~\ECS. That is, the better this condition is met, the more the generalizing components concentrate in this \ECS, and this tendency provides a new layer quality metric, derived in a totally independent way from \ALPHA and \ALPHAHAT. We will provide strong empirical justification that both metrics are acceptable Quality metrics by showing that they converge as model quality increases.

\red{[There are forward pointers to \ref{sxn:empirical}, but not to \ref{sxn:matgen}. \ref{sxn:matgen} fulfills the claims of derivation. I suggest to start a new paragraph here, and add one above that does a similar job relating results in Section \ref{sxn:matgen} to claims being made here. This is one of the most critical pages in the whole paper.]}\\
Importantly, we have conducted detailed experiments to show 
that the empirical estimates of the \SETOL \TRACELOG condition align remarkably well with predictions from the \HTSR
theory under \Ideal conditions (see Sections~\ref{sxn:empirical-test_acc}) and, then, 
that the key assumptions of our \SETOL theory are valid
(see Sections~\ref{sxn:empirical-effective_corr_space} and \ref{sxn:empirical-trace_log}).
In Section~\ref{sxn:empirical_comp_r_transforms}, we demonstrate how to apply theory directly using explicit calculations of the \RMT layer cumulants.
We next examine how the \HTSR predictions (i.e., the HT PL exponent $\alpha$) behave under non-\Ideal conditions (see Sections~\ref{sxn:empirical-correlation_trap} and \ref{sxn:hysteresis_effect}).
%
In the following, we will outline key conceptual aspects of \SETOL.
In Section~\ref{sxn:setol_overview}, we give an overview of \SETOL;
In Section~\ref{sxn:ideal_learning}, we describe the conditions of \Ideal learning under \SETOL and how they differ from those of \HTSR; and
In Section~\ref{sxn:HT_ESDs} we describe conditions that deviate from this.

\begin{figure}[htbp]                 % place here / top / bottom / page
  \centering
  % --- scale the entire picture to 75 % ---
  \scalebox{0.75}{\input{sections/flowchart}}   % path to flowchart.tex (no “.tex” needed)

  \caption{Flowchart of the theoretical concepts used to construct SETOL.}
  \label{fig:cetl-flow}
\end{figure}
\input{sections/310_setol_overview}
\input{sections/320_setol_comparisons}
\input{sections/330_setol_detecting}
