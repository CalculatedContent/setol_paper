\subsection{The Inverse-MP (IMP) Model}
\label{sxn:IMP}
In this section, we rederive the integral $G(\lambda)[IMP]$ for the \InverseMP (IMP) model, focusing on the branch cut starting at $z = \kappa/2$ and extending to infinity. 
\michael{We derive, not rederive, right?  Section \ref{sxn:r_transforms} just points here.  }
This branch cut corresponds to the support of the ESD in this region. 
We will:
\begin{enumerate}
\item Explain the presence of the branch cut and its implications.
\item Show that $R(z)[IMP]$ becomes complex along this branch cut because the term under the square root becomes negative.
\item Perform the integral $G(\lambda)[IMP]$, showing all steps.
\item Compute the modulus $|G(\lambda)[IMP]| = \sqrt{ G(\lambda)[IMP]^* G(\lambda)[IMP] }$ to obtain a real-valued estimate, analogous to a probability estimate.
\end{enumerate}
\nred{Note: Below, we may want the Real part of $G(\lambda)[IMP]$ and not the modulus. Stil thinking on this.
  Also, we may want to add additional parameters to the IMP model to account for the dimension of the matrix.
This changes things  bit.}

\subsubsection{The Branch Cut in the IMP Model}

The R-transform for the IMP model is given by:
\begin{align}
\label{eqn:iw_r_transf}
R(z)[IMP] = \frac{\kappa - \sqrt{\kappa(\kappa - 2z)}}{z},
\end{align}
where $\kappa > 0$ is a parameter related to the dimensions of the random matrices under consideration.
\michael{Ref.}
The function $\sqrt{\kappa(\kappa - 2z)}$ introduces a branch point at $z = \kappa/2$ because the argument of the square root becomes zero at this point:
\begin{align}
\kappa - 2z = 0 \quad \Rightarrow \quad z = \frac{\kappa}{2}.
\end{align}
For $z > \kappa/2$, the argument $\kappa - 2z$ becomes negative, and thus the square root becomes imaginary. 
This leads to a branch cut starting at $z = \kappa/2$ and extending to $z = \infty$ along the real axis. 
This branch cut affects the analyticity of $R(z)[IMP]$, and it must be carefully considered in the integral $G(\lambda)[IMP]$.

\subsubsection{$R(z)[IMP]$ is Complex Along the Branch Cut}

For $z > \kappa/2$, we have:
\begin{align}
\kappa - 2z < 0 \quad \Rightarrow \quad \sqrt{\kappa(\kappa - 2z)} = \sqrt{-\kappa(2z - \kappa)} = i \sqrt{\kappa(2z - \kappa)}.
\end{align}
%
Therefore, $R(z)[IMP]$ becomes complex:
\begin{align}
R(z)[IMP] = \frac{\kappa - i \sqrt{\kappa(2z - \kappa)}}{z} = \frac{\kappa}{z} - i \frac{ \sqrt{ \kappa(2z - \kappa) } }{ z }.
\end{align}
%
This expression shows that $R(z)[IMP]$ has both real and imaginary parts when $z > \kappa/2$.

\subsubsection{Calculation of $G(\lambda)[IMP]$}

We aim to compute the integral:
\begin{align}
G(\lambda)[IMP] = \int_{z_0}^\lambda R(z)[IMP] , dz,
\end{align}
where $z_0 \geq \kappa/2$.


\paragraph{Integrating the Real Part.}

First, we consider the real part of $R(z)[IMP]$:
\begin{align}
\text{Re}[R(z)[IMP]] = \frac{\kappa}{z}.
\end{align}
%
The integral of this real part is:
\begin{align}
G_{\text{real}}(\lambda)[IMP] = \int_{z_0}^\lambda \frac{\kappa}{z} , dz = \kappa \left[ \ln z \right]_{z_0}^\lambda = \kappa \left( \ln \lambda - \ln z_0 \right).
\end{align}


\paragraph{Integrating the Imaginary Part.}

Next, consider the imaginary part:
\begin{align}
\text{Im}[R(z)[IMP]] = - \frac{ \sqrt{ \kappa(2z - \kappa) } }{ z }.
\end{align}
%
If we let $u = 2z - \kappa$, then:
\begin{align}
z = \frac{u + \kappa}{2}, \quad dz = \frac{du}{2}.
\end{align}
%
Substituting this into the imaginary part:
\begin{align}
\text{Im}[R(z)[IMP]] = - \frac{ \sqrt{ \kappa u } }{ \frac{u + \kappa}{2} } = - \frac{ 2 \sqrt{ \kappa u } }{ u + \kappa } ,
\end{align}
the integral becomes:
\begin{align}
G_{\text{imag}}(\lambda)[IMP] 
   = \int_{u_0}^{u_\lambda} - \frac{ 2 \sqrt{ \kappa u } }{ u + \kappa } \cdot \frac{du}{2}  
   = - \int_{u_0}^{u_\lambda} \frac{ \sqrt{ \kappa u } }{ u + \kappa } du  ,
\end{align}
where $u_0 = 2 z_0 - \kappa$ and $u_\lambda = 2 \lambda - \kappa$.
%
If we simplify the integrand:
\begin{align}
\sqrt{ \kappa u } = \sqrt{ \kappa } \sqrt{ u }, 
\end{align}
%
then the integral becomes:
\begin{align}
G_{\text{imag}}(\lambda)[IMP] = - \sqrt{ \kappa } \int_{u_0}^{u_\lambda} \frac{ \sqrt{ u } }{ u + \kappa } , du.
\end{align}
%
This integral can be evaluated using standard integral formulas. 
We will compute it step by step.


\paragraph{Evaluating the Integral.}

Consider the integral:
\begin{align}
I = \int \frac{ \sqrt{ u } }{ u + \kappa } , du.
\end{align}
%
We can use the following integral formula:
\begin{align}
\int \frac{ \sqrt{ u } }{ u + a } , du = 2 \sqrt{ u } - 2 a \tan^{-1} \left( \frac{ \sqrt{ u } }{ \sqrt{ a } } \right ) + C,
\end{align}
where $a > 0$ and $u > 0$.
%
Applying this formula, we get:
\begin{align}
I = 2 \sqrt{ u } - 2 \kappa \tan^{-1} \left( \frac{ \sqrt{ u } }{ \sqrt{ \kappa } } \right ) + C.
\end{align}
%
Therefore, the imaginary part of $G(\lambda)[IMP]$ is:
\begin{align}
\nonumber
G_{\text{imag}}(\lambda)[IMP] 
   &= - \sqrt{ \kappa } \left[ 2 \sqrt{ u } - 2 \kappa \tan^{-1} \left( \frac{ \sqrt{ u } }{ \sqrt{ \kappa } } \right ) \right ]{u_0}^{u\lambda} \\
\nonumber
   &= - \sqrt{ \kappa } \left( \left[ 2 \sqrt{ u_\lambda } - 2 \kappa \tan^{-1} \left( \frac{ \sqrt{ u_\lambda } }{ \sqrt{ \kappa } } \right ) \right ] - \left[ 2 \sqrt{ u_0 } - 2 \kappa \tan^{-1} \left( \frac{ \sqrt{ u_0 } }{ \sqrt{ \kappa } } \right ) \right ] \right ) \\
   &= - 2 \sqrt{ \kappa } \left( \sqrt{ u_\lambda } - \sqrt{ u_0 } \right ) + 2 \kappa^{ 3/2 } \left( \tan^{-1} \left( \frac{ \sqrt{ u_\lambda } }{ \sqrt{ \kappa } } \right ) - \tan^{-1} \left( \frac{ \sqrt{ u_0 } }{ \sqrt{ \kappa } } \right ) \right ).
\end{align}


\paragraph{Combining Real and Imaginary Parts.}

Combine the real and imaginary parts to obtain $G(\lambda)[IMP]$:
\begin{align}
G(\lambda)[IMP] = G_{\text{real}}(\lambda)[IMP] + i G_{\text{imag}}(\lambda)[IMP].
\end{align}
%
Substituting the expressions:
\begin{align}
\nonumber
G(\lambda)[IMP] 
   &= \kappa \left( \ln \lambda - \ln z_0 \right )   \\
   &\quad + i \left( - 2 \sqrt{ \kappa } \left( \sqrt{ u_\lambda } - \sqrt{ u_0 } \right ) + 2 \kappa^{ 3/2 } \left( \tan^{-1} \left( \frac{ \sqrt{ u_\lambda } }{ \sqrt{ \kappa } } \right ) - \tan^{-1} \left( \frac{ \sqrt{ u_0 } }{ \sqrt{ \kappa } } \right ) \right ) \right ).
\end{align}
%
Recall that $u = 2z - \kappa$, so:
\begin{align}
\sqrt{ u } = \sqrt{ 2z - \kappa }.
\end{align}
%
Therefore, we can write $G(\lambda)[IMP]$ as:
\begin{align}
\nonumber
G(\lambda)[IMP] 
   &= \kappa \ln \left( \frac{ \lambda }{ z_0 } \right ) - 2 i \sqrt{ \kappa } \left( \sqrt{ 2 \lambda - \kappa } - \sqrt{ 2 z_0 - \kappa } \right ) \\
   &\quad + 2 i \kappa^{ 3/2 } \left( \tan^{-1} \left( \frac{ \sqrt{ 2 \lambda - \kappa } }{ \sqrt{ \kappa } } \right ) - \tan^{-1} \left( \frac{ \sqrt{ 2 z_0 - \kappa } }{ \sqrt{ \kappa } } \right ) \right ).
\end{align}


\subsubsection{Computing the Modulus $|G(\lambda)[IMP]|$}

To obtain a real-valued estimate, we compute the modulus of $G(\lambda)[IMP]$:
\begin{align}
| G(\lambda)[IMP] | = \sqrt{ \left( \text{Re}[ G(\lambda)[IMP] ] \right )^2 + \left( \text{Im}[ G(\lambda)[IMP] ] \right )^2 }.
\end{align}


\paragraph{Calculating the Real Part Square.}

The real part is:
\begin{align}
\text{Re}[ G(\lambda)[IMP] ] = \kappa \ln \left( \frac{ \lambda }{ z_0 } \right ).
\end{align}
%
Therefore,
\begin{align}
\left( \text{Re}[ G(\lambda)[IMP] ] \right )^2 = \kappa^2 \left( \ln \left( \frac{ \lambda }{ z_0 } \right ) \right )^2.
\end{align}


\paragraph{Calculating the Imaginary Part Square.}

The imaginary part is:
\begin{align}
\text{Im}[ G(\lambda)[IMP] ] &= - 2 \sqrt{ \kappa } \left( \sqrt{ 2 \lambda - \kappa } - \sqrt{ 2 z_0 - \kappa } \right ) \
&\quad + 2 \kappa^{ 3/2 } \left( \tan^{-1} \left( \frac{ \sqrt{ 2 \lambda - \kappa } }{ \sqrt{ \kappa } } \right ) - \tan^{-1} \left( \frac{ \sqrt{ 2 z_0 - \kappa } }{ \sqrt{ \kappa } } \right ) \right ).
\end{align}
%
Letâ€™s denote:
\begin{align}
A &= - 2 \sqrt{ \kappa } \left( \sqrt{ 2 \lambda - \kappa } - \sqrt{ 2 z_0 - \kappa } \right ), \
B &= 2 \kappa^{ 3/2 } \left( \tan^{-1} \left( \frac{ \sqrt{ 2 \lambda - \kappa } }{ \sqrt{ \kappa } } \right ) - \tan^{-1} \left( \frac{ \sqrt{ 2 z_0 - \kappa } }{ \sqrt{ \kappa } } \right ) \right ).
\end{align}
%
Then,
\begin{align}
\left( \text{Im}[ G(\lambda)[IMP] ] \right )^2 = (A + B)^2 = A^2 + 2AB + B^2.
\end{align}


\paragraph{Computing the Modulus.}

The modulus is:
\begin{align}
| G(\lambda)[IMP] | = \sqrt{ \left( \kappa \ln \left( \frac{ \lambda }{ z_0 } \right ) \right )^2 + \left( A + B \right )^2 }.
\end{align}


\paragraph{Interpretation.}

While the expression for $| G(\lambda)[IMP] |$ appears complex, it encapsulates the cumulative effect of both the real and imaginary components of $G(\lambda)[IMP]$. This modulus provides a real-valued estimate that is meaningful in the context of probability estimates.


\subsubsection{Summary}

By integrating $R(z)[IMP]$ directly, including its complex components, we have obtained an explicit expression for $G(\lambda)[IMP]$ as a complex function. 
Computing the modulus $| G(\lambda)[IMP] |$ gives us a real-valued function that accurately captures the contribution of the tail of the ESD in the IMP model.
%
This approach accounts for the complex nature of $R(z)[IMP]$ along the branch cut $z > \kappa/2$, and it provides a meaningful point estimate for further analysis.
\michaeladdressed{By that, I assume we mean that we will use it in our derivation.}


